<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: JETBRAINS_DEVCONTAINER_FIX
  
    &mdash; Documentation by YARD 0.9.38
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "JETBRAINS_DEVCONTAINER_FIX";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: JETBRAINS_DEVCONTAINER_FIX</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="jetbrains-devcontainer-fix---tree-sitter-setup-scripts">JetBrains DevContainer Fix - Tree-Sitter Setup Scripts</h1>

<h2 id="problem">Problem</h2>

<p>The devcontainer apt-install scripts were looking for the setup scripts in <code>/workspaces/&lt;project&gt;</code> but JetBrains IDEs mount projects in <code>/IdeaProjects/&lt;project&gt;</code>, causing the container build to fail.</p>

<h2 id="solution">Solution</h2>

<p>Updated all 11 gems’ <code>apt-install/install.sh</code> scripts to check <code>/IdeaProjects/&lt;project&gt;</code> FIRST, before falling back to other common paths.</p>

<h2 id="files-fixed">Files Fixed</h2>

<h3 id="single-grammar-gems-4">Single-Grammar Gems (4)</h3>
<ol>
  <li><code>vendor/toml-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/json-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/jsonc-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/bash-merge/.devcontainer/apt-install/install.sh</code></li>
</ol>

<h3 id="multi-grammar-gems-7">Multi-Grammar Gems (7)</h3>
<ol>
  <li>
<code>.devcontainer/apt-install/install.sh</code> (ast-merge root)</li>
  <li><code>vendor/tree_haver/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/commonmarker-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/markdown-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/markly-merge/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/kettle-dev/.devcontainer/apt-install/install.sh</code></li>
  <li><code>vendor/kettle-jem/.devcontainer/apt-install/install.sh</code></li>
</ol>

<h2 id="change-made">Change Made</h2>

<p><strong>Before</strong> (only checked /workspaces):</p>
<pre class="code language-bash"><code class="language-bash">for candidate in \
  &quot;/workspaces/toml-merge/.github/scripts/ubuntu/setup-tree-sitter.sh&quot; \
  &quot;/workspace/toml-merge/.github/scripts/ubuntu/setup-tree-sitter.sh&quot; \
  ...
</code></pre>

<p><strong>After</strong> (checks /IdeaProjects FIRST):</p>
<pre class="code language-bash"><code class="language-bash">for candidate in \
  &quot;/IdeaProjects/toml-merge/.github/scripts/ubuntu/setup-tree-sitter.sh&quot; \
  &quot;/workspaces/toml-merge/.github/scripts/ubuntu/setup-tree-sitter.sh&quot; \
  &quot;/workspace/toml-merge/.github/scripts/ubuntu/setup-tree-sitter.sh&quot; \
  ...
</code></pre>

<h2 id="why-this-works">Why This Works</h2>

<ol>
  <li>
<strong>JetBrains IDEs</strong> (RubyMine, IntelliJ IDEA) mount projects in <code>/IdeaProjects/&lt;name&gt;</code>
</li>
  <li>
<strong>VS Code</strong> mounts projects in <code>/workspaces/&lt;name&gt;</code>
</li>
  <li>By checking <code>/IdeaProjects/</code> first, we support both environments</li>
  <li>The loop exits as soon as it finds the script in any location</li>
</ol>

<h2 id="testing">Testing</h2>

<p>The devcontainer should now build successfully in JetBrains IDEs. You can verify with:</p>

<pre class="code language-bash"><code class="language-bash"># Rebuild the devcontainer
# The apt-install feature will run during build
# It should find the script at /IdeaProjects/&lt;project&gt;/.github/scripts/ubuntu/setup-tree-sitter.sh
# And successfully install tree-sitter grammar(s)
</code></pre>

<h2 id="additional-improvements-made">Additional Improvements Made</h2>

<p>While fixing the path issue, I also:</p>

<ol>
  <li>
<strong>Added <code>set -e</code></strong>: Exit on error for better failure detection</li>
  <li>
<strong>Added grammar verification</strong>: Check that expected .so files were installed</li>
  <li>
<strong>Standardized format</strong>: All 11 apt-install scripts now follow the same pattern</li>
  <li>
<strong>Better comments</strong>: Clarified single vs multi-grammar needs</li>
</ol>

<h2 id="complete-summary">Complete Summary</h2>

<ul>
  <li>
<strong>11 files fixed</strong>: All gems’ apt-install scripts now support JetBrains path</li>
  <li>
<strong>Backward compatible</strong>: Still works with VS Code and other environments</li>
  <li>
<strong>Priority order</strong>: /IdeaProjects first, then /workspaces, then fallbacks</li>
  <li>
<strong>No breaking changes</strong>: Existing setups continue to work</li>
</ul>

<h2 id="path-priority-order">Path Priority Order</h2>

<p>The scripts check paths in this order:</p>
<ol>
  <li>
<code>/IdeaProjects/&lt;project&gt;/</code> - JetBrains IDEs</li>
  <li>
<code>/workspaces/&lt;project&gt;/</code> - VS Code (common)</li>
  <li>
<code>/workspace/&lt;project&gt;/</code> - Alternative VS Code path</li>
  <li>
<code>/home/vscode/&lt;project&gt;/</code> - VS Code alternative user</li>
  <li>
<code>/root/&lt;project&gt;/</code> - Root user fallback</li>
</ol>

<p>This ensures maximum compatibility across different devcontainer implementations.</p>
</div></div>

      <div id="footer">
  Generated on Sun Dec 28 18:06:57 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-4.0.0).
</div>

    </div>
  </body>
</html>