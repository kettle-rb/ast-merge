<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: SMART_MERGER_AUDIT
  
    &mdash; Documentation by YARD 0.9.38
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "SMART_MERGER_AUDIT";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: SMART_MERGER_AUDIT</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="smartmerger-api-audit">SmartMerger API Audit</h1>

<p><strong>Date:</strong> December 20, 2025</p>

<p>This document audits all <code>*-merge</code> gem SmartMerger implementations for compliance with the standard options defined in <code>Ast::Merge::SmartMergerBase</code>.</p>

<h2 id="standard-options-from-astmergesmartmergerbase">Standard Options (from <code>Ast::Merge::SmartMergerBase</code>)</h2>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Type</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>signature_generator</code></td>
      <td><code>Proc, nil</code></td>
      <td><code>nil</code></td>
      <td>Custom signature generator</td>
    </tr>
    <tr>
      <td><code>preference</code></td>
      <td><code>Symbol, Hash</code></td>
      <td><code>:destination</code></td>
      <td>Which version wins on conflicts</td>
    </tr>
    <tr>
      <td><code>add_template_only_nodes</code></td>
      <td><code>Boolean</code></td>
      <td><code>false</code></td>
      <td>Add nodes only in template</td>
    </tr>
    <tr>
      <td><code>freeze_token</code></td>
      <td><code>String, nil</code></td>
      <td>varies</td>
      <td>Token for freeze block markers</td>
    </tr>
    <tr>
      <td><code>match_refiner</code></td>
      <td><code>#call, nil</code></td>
      <td><code>nil</code></td>
      <td>Fuzzy matching refinement</td>
    </tr>
    <tr>
      <td><code>regions</code></td>
      <td><code>Array&lt;Hash&gt;, nil</code></td>
      <td><code>nil</code></td>
      <td>Region configs for nested merging</td>
    </tr>
    <tr>
      <td><code>region_placeholder</code></td>
      <td><code>String, nil</code></td>
      <td><code>nil</code></td>
      <td>Custom placeholder for regions</td>
    </tr>
    <tr>
      <td><code>node_typing</code></td>
      <td><code>Hash, nil</code></td>
      <td><code>nil</code></td>
      <td>Per-node-type merge preferences</td>
    </tr>
  </tbody>
</table>

<h2 id="audit-results">Audit Results</h2>

<h3 id="-full-compliance-inherits-from-astmergesmartmergerbase">✅ Full Compliance (Inherits from <code>Ast::Merge::SmartMergerBase</code>)</h3>

<table>
  <thead>
    <tr>
      <th>Gem</th>
      <th>Base Class</th>
      <th>Missing Options</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>prism-merge</strong></td>
      <td><code>Ast::Merge::SmartMergerBase</code></td>
      <td>None</td>
      <td>✅ Also has <code>node_typing</code>, <code>max_recursion_depth</code>
</td>
    </tr>
    <tr>
      <td><strong>psych-merge</strong></td>
      <td><code>Ast::Merge::SmartMergerBase</code></td>
      <td>None</td>
      <td>✅ Full compliance</td>
    </tr>
    <tr>
      <td><strong>json-merge</strong></td>
      <td><code>Ast::Merge::SmartMergerBase</code></td>
      <td>None</td>
      <td>✅ Fixed 2024-12-20</td>
    </tr>
    <tr>
      <td><strong>toml-merge</strong></td>
      <td><code>Ast::Merge::SmartMergerBase</code></td>
      <td>None</td>
      <td>✅ Fixed 2024-12-20</td>
    </tr>
  </tbody>
</table>

<h3 id="-non-compliant-own-implementation">❌ Non-Compliant (Own Implementation)</h3>

<table>
  <thead>
    <tr>
      <th>Gem</th>
      <th>Base Class</th>
      <th>Missing Options</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>markdown-merge</strong></td>
      <td>Own <code>SmartMergerBase</code>
</td>
      <td><code>regions</code></td>
      <td>✅ Fixed 2024-12-20: Added <code>node_typing</code>
</td>
    </tr>
    <tr>
      <td><strong>markly-merge</strong></td>
      <td><code>Markdown::Merge::SmartMerger</code></td>
      <td><code>regions</code></td>
      <td>✅ Inherits markdown-merge <code>node_typing</code>
</td>
    </tr>
    <tr>
      <td><strong>commonmarker-merge</strong></td>
      <td><code>Markdown::Merge::SmartMerger</code></td>
      <td><code>regions</code></td>
      <td>✅ Inherits markdown-merge <code>node_typing</code>
</td>
    </tr>
    <tr>
      <td><strong>bash-merge</strong></td>
      <td>Own implementation</td>
      <td>
<code>match_refiner</code>, <code>regions</code>, <code>node_typing</code>
</td>
      <td>Complete own implementation</td>
    </tr>
    <tr>
      <td><strong>rbs-merge</strong></td>
      <td>Own implementation</td>
      <td>
<code>match_refiner</code>, <code>regions</code>, <code>node_typing</code>
</td>
      <td>Has <code>max_recursion_depth</code>
</td>
    </tr>
    <tr>
      <td><strong>dotenv-merge</strong></td>
      <td>Own implementation</td>
      <td>
<code>match_refiner</code>, <code>regions</code>, <code>node_typing</code>
</td>
      <td>Basic implementation</td>
    </tr>
    <tr>
      <td><strong>jsonc-merge</strong></td>
      <td>Own implementation</td>
      <td>Most options</td>
      <td>Minimal PoC</td>
    </tr>
  </tbody>
</table>

<h2 id="detailed-analysis">Detailed Analysis</h2>

<h3 id="prism-merge-">prism-merge ✅</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger &lt; ::Ast::Merge::SmartMergerBase
  # Full support: signature_generator, preference (Hash supported), 
  # add_template_only_nodes, freeze_token, node_typing, max_recursion_depth,
  # match_refiner, regions, region_placeholder
</code></pre>

<h3 id="psych-merge-">psych-merge ✅</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger &lt; ::Ast::Merge::SmartMergerBase
  # Full support: signature_generator, preference, add_template_only_nodes,
  # freeze_token, match_refiner, regions, region_placeholder
</code></pre>

<h3 id="json-merge-️">json-merge ⚠️</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger &lt; ::Ast::Merge::SmartMergerBase
  # MISSING in initialize: signature_generator, freeze_token
  # These are not passed to super(), so users can&#39;t use them!
</code></pre>

<h3 id="toml-merge-️">toml-merge ⚠️</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger &lt; ::Ast::Merge::SmartMergerBase
  # MISSING in initialize: signature_generator, freeze_token
  # Same issue as json-merge
</code></pre>

<h3 id="markdown-merge-">markdown-merge ❌</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMergerBase  # NOT inheriting from Ast::Merge::SmartMergerBase!
  # Own implementation, missing:
  # - node_typing (for per-node-type preference)
  # - regions/region_placeholder (for nested merging)
  # Has markdown-specific: inner_merge_code_blocks
</code></pre>

<h3 id="bash-merge-">bash-merge ❌</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger  # NOT inheriting from any base!
  # Own implementation, missing:
  # - match_refiner
  # - regions/region_placeholder
  # - node_typing
</code></pre>

<h3 id="rbs-merge-">rbs-merge ❌</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger  # NOT inheriting from any base!
  # Own implementation, missing:
  # - match_refiner
  # - regions/region_placeholder
  # - node_typing
  # Has: max_recursion_depth
</code></pre>

<h3 id="dotenv-merge-">dotenv-merge ❌</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger  # NOT inheriting from any base!
  # Own implementation, supports:
  # - preference, add_template_only_nodes, freeze_token, signature_generator
  # Missing:
  # - match_refiner
  # - regions/region_placeholder
  # - node_typing
</code></pre>

<h3 id="jsonc-merge-">jsonc-merge ❌</h3>
<pre class="code language-ruby"><code class="language-ruby">class SmartMerger  # NOT inheriting from any base!
  # Minimal PoC, only has:
  # - preference, add_template_only_nodes (via options hash)
  # Missing everything else
</code></pre>

<h2 id="priority-fixes-needed">Priority Fixes Needed</h2>

<h3 id="-completed-2024-12-20">✅ Completed (2024-12-20)</h3>

<ol>
  <li>
<strong>json-merge</strong>: ✅ Added <code>signature_generator</code> and <code>freeze_token</code> to <code>initialize</code>
</li>
  <li>
<strong>toml-merge</strong>: ✅ Same as json-merge</li>
  <li>
<strong>markdown-merge</strong>: ✅ Added <code>node_typing</code> support for per-node-type preference</li>
  <li>
<strong>markly-merge</strong>: ✅ Inherits <code>node_typing</code> from markdown-merge</li>
  <li>
<strong>commonmarker-merge</strong>: ✅ Inherits <code>node_typing</code> from markdown-merge</li>
</ol>

<h3 id="medium-priority-missing-standard-features">Medium Priority (Missing Standard Features)</h3>

<ol>
  <li>
<strong>markdown-merge</strong>: Consider adding <code>regions</code> support</li>
  <li>
<strong>bash-merge</strong>: Consider migrating to inherit from base class</li>
  <li>
<strong>rbs-merge</strong>: Consider migrating to inherit from base class</li>
</ol>

<h3 id="low-priority-works-but-non-standard">Low Priority (Works but Non-Standard)</h3>

<ol>
  <li>
<strong>dotenv-merge</strong>: Consider migrating to base class</li>
  <li>
<strong>jsonc-merge</strong>: PoC - may need rewrite anyway</li>
</ol>

<h2 id="recommended-fix-order">Recommended Fix Order</h2>

<h3 id="-completed-2024-12-20-1">✅ Completed 2024-12-20</h3>

<ol>
  <li>✅ Fixed json-merge and toml-merge (added missing params)</li>
  <li>✅ Added node_typing to markdown-merge (enables per-node-type preference)</li>
  <li>✅ Updated markly-merge and commonmarker-merge to pass node_typing</li>
</ol>

<h3 id="remaining-work">Remaining Work</h3>

<ol>
  <li>Consider adding <code>regions</code> support to markdown-merge</li>
  <li>Consider refactoring bash-merge, rbs-merge, dotenv-merge to inherit from base class</li>
</ol>
</div></div>

      <div id="footer">
  Generated on Sun Dec 28 16:22:19 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-4.0.0).
</div>

    </div>
  </body>
</html>